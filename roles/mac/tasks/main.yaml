---
- name: Install Required Packages
  homebrew:
    name={{ item }}
    state=present
    update_homebrew=yes
    upgrade_all=yes
  with_items:
    - python
    - stunnel
    - git
    - cmake

- name: Install buildbot-slave system-wide
  pip:
    name='buildbot-slave'

#- name: Make symlinks
#    become: yes
#    become_user: administrator

#- name: Fix $PATH
# $ echo 'export PATH=/usr/local/bin:$PATH' >>~/.bashrc
# $ echo '. ~/.bashrc' >~/.bash_profile


- name: Clone the Buildbot configs
  git:
      repo='https://github.com/rust-lang/rust-buildbot.git'
      dest='/home/rustbuild/rust-buildbot'
      accept_hostkey=yes

- name: Create venv for buildslave
  pip: 
    virtualenv={{venv_path}}
    name='buildbot'
# TODO: open ports for buildslave
